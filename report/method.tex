%!TEX root = report.tex
\Cref{alg:method:mmc} presents the pseudo code of the Metropolis Monte Carlo algorithm applied to the Ising problem. This section starts by discussing the input of this algorithm and then introduces the functions used in \cref{alg:method:mmc} one by one. It should be noted that the discussed algorithm is agnostic to the dimensionality of the model. 

\input{pseudo_mmc}

\Cref{alg:method:mmc} requires an initial configuration \configuration{\mathit{init}} as input, this configuration is a representation of the system in its initial state. The parameter \numberOfIterations indicates how many configurations are generated, generally \mbox{\numberOfIterations = \numberOfSpins}. Before the start of the first loop the the current configuration is set to the initial configuration.

$\FuncSty{selectRandomSpin()}$ selects on spin randomly from the spins in \configuration{\mathit{cur}}. The potential configuration, \configuration{\mathit{pot}} is a copy of \configuration{\mathit{cur}} with the selected spin, \spin{}, flipped. This new configuration is generated by \FuncSty{flipSin()}. The new current configuration is selected by \FuncSty{selectConfig()}. The pseudo code of this function is presented in \cref{alg:method:selectConfig}.

\input{pseudo_selectconfig}

Given two configurations, \configuration{\mathit{pot}} and \configuration{\mathit{cur}}, \FuncSty{selectConfig()} selects with which one the simulation should continue. To this end $\Delta\energy$, the difference in energy between the two configurations, is computed. It is not possible to compute the energy of the two configurations according to \cref{eq:intro:ising:2d:energy}. However writing \cref{eq:intro:ising:1D:hamiltonian} as
	\begin{equation}\label{eq:method:hamiltonian}
			\hamiltonian\left(\configuration{}\right) = - \spin{i} \sum_{j \in \neighbourhood{\spin{i}}} \spin{j} + \mathit{remainder}
	\end{equation}
where $\neighbourhood{\spin{i}}$ is the neighborhood of \spin{i} allows us to see that since only \spin{i} changes the $\mathit{remainder}$ of $\hamiltonian\left(\configuration{\mathit{cur}}\right)$ and $\hamiltonian\left(\configuration{\mathit{pot}}\right)$ are the same \cite{kenzel1997physics}. Thus only the first term in \cref{eq:method:hamiltonian} is relevant for the computation of $\Delta\energy$, consequently we find:
\begin{equation}\label{eq:method:deltaEnergy}
	\Delta\energy = - 2 \cdot \spin{i} \sum_{j \in \neighbourhood{\spin{i}}} \spin{j}.
\end{equation}
If a the potential configuration is determined is decided by two values: $\theta$ and $\xi$. The first is sampled from a pseudo random uniform distribution with the range $\left(0, 1\right)$. The second is computed from $\Delta\energy$ according to
\begin{equation}
	\xi = \exp\left[- \beta\Delta\energy \right].
\end{equation}
If the transition from \configuration{\mathit{cur}} to \configuration{\mathit{pot}} decreases the energy of the system $\xi$ is greater than one and as \mbox{$\theta \in \left(0, 1\right)$} potential states with an energy that is lower than that of the current state are always accepted. The guard of the \t{if} also ensures that state transitions that increase the energy, \ie \mbox{$\xi < 1$}, are not necessarily discarded.

The implementation of the presented algorithm can be found in \cref{lst:simulation:mmci,lst:simulation:neighbours1d,lst:simulation:neighbours2d} in \cref{app:implementation:simulation}.